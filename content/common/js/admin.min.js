!function(e,t,n,o){"use strict";var s=t.csk=t.csk||{};s.i18n=s.i18n||{},"undefined"!=typeof bootbox&&bootbox.setDefaults({backdrop:!1,closeButton:!1,locale:s.config.lang.code,size:"small"}),s.ui={confirm:function(e,t,n){"undefined"!=typeof bootbox?bootbox.confirm({message:e,buttons:{confirm:{className:"btn btn-primary btn-sm"},cancel:{className:"btn btn-default btn-sm"}},callback:function(e){bootbox.hideAll(),!0===e&&"function"==typeof t?t(!0):"function"==typeof n&&n(!0)}}):confirm(e)&&"function"==typeof t?t(!0):"function"==typeof n&&n(!0)},alert:function(t,o){if(!t.length)return!1;if("error"===(o=o||"info")&&(o="danger"),"undefined"==typeof toastr)if("object"!=typeof Handlebars)alert(t.replace(/(<([^>]+)>)/gi,""));else{var s=e("#csk-alert"),i=n.getElementById("csk-alert-template").innerHTML,a=Handlebars.compile(i)({message:t,type:o});s.length?s.fadeOut(function(){e(this).remove(),e(a).prependTo("#wrapper > .container")}):e(a).prependTo("#wrapper > .container")}else switch(o){case"success":toastr.success(t);break;case"error":case"danger":toastr.error(t);break;case"warning":toastr.warning(t);break;case"info":default:toastr.info(t)}},reload:function(t,n){t=t||"#wrapper",!0===(n=n||!0)&&e("#navbar-admin").load(s.config.currentURL+" #navbar-admin > *"),t.length&&e(t).load(s.config.currentURL+" "+t+" > *")}},s.ajax={requests:[],requesting:!1,context:o,request:function(t,n){(n=n||{}).context;var i=n.type||"GET";n=e.extend({url:t,method:i,type:i,async:!0,cache:!1,dataType:"json",success:function(e,t,n){s.ajax._response(e)},error:function(e,t,n){var i=e.responseJSON||o;void 0!==i&&"undefined"!==i.message&&i.message.length&&s.ui.alert(i.message,"error")}},n),this.requests.push(n),this._execute()},stop:function(){this.requests=[]},_execute:function(){if(0!=this.requests.length&&1!=this.requesting){var t=this.requests.splice(0,1)[0],n=t.complete,o=this;t._execute&&t._execute(t),t.complete=function(){n&&n.apply(this,arguments),o.requesting=!1,o._execute()},this.requesting=!0,e.ajax(t)}},_response:function(e){e=e||{};if(s.ajax.context=this,void 0!==e.message&&e.message.length&&s.ui.alert(e.message,"success"),void 0!==e.scripts)for(var t=e.scripts.length,n=0;n<t;n++)try{new Function(e.scripts[n]).call(this)}catch(e){console.log(e)}}},e(n).ready(function(){if("undefined"!=typeof toastr&&(toastr.options={closeButton:!0,positionClass:"toast-top-center",hideDuration:"300",timeOut:"2500",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},"rtl"===s.config.lang.direction&&(toastr.options.rtl=!0)),e(n).on("change",":checkbox[name=check-all]",function(){e(this).closest("table").find("tbody :checkbox").prop("checked",this.checked).closest("tr").toggleClass("selected",this.checked)}),e(n).on("change",":checkbox.check-this",function(){e(this).parents("tr").toggleClass("selected",this.checked)}),void 0!==e.fn.tooltip&&e("[data-toggle=tooltip], [rel=tooltip]").tooltip(),void 0!==e.fn.popover&&e("[data-toggle=popover], [rel=popover]").popover(),e(n).on("submit","form",function(t){var n=e(this);return n.find("[type=submit]").prop("disabled",!0).addClass("disabled"),n.submit(function(){return!1}),!0}),void 0!==e.fn.garlic&&e("[rel=persist]").garlic(),e(n).on("click","a[rel]",function(n){var o=e(this),i=o.attr("rel"),a=o.attr("href");if(void 0===a||!a.length)return n.preventDefault(),!1;if(i.length&&"async"===i&&"async-post"===i){n.preventDefault();var r="async"===i?"GET":"POST";return s.ajax.request(a,{el:this,type:r,beforeSend:function(){o.prop("disabled")||o.prop("disabled",!0).addClass("disabled")},complete:function(){o.prop("disabled",!1).removeClass("disabled")}}),!1}t.location.href=a}),e(n).on("submit","form[rel]",function(t){var n=e(this),o=n.attr("rel"),i=n.attr("action");if(void 0===i||!i.length)return t.preventDefault(),!1;switch(o){case"async":return t.preventDefault(),s.ajax.request(i,{el:this,type:"POST",data:n.serializeArray(),beforeSend:function(){n.prop("disabled")||n.find("[type=submit]").prop("disabled",!0).addClass("disabled")},complete:function(){n.find("[type=submit]").prop("disabled",!1).removeClass("disabled")}}),!1}}),void 0!==e.fn.modal){var o=e(".modal");o.length&&o.modal("show")}e(n).on("hidden.bs.modal",".modal",function(t){e(this).remove()}),e(n).on("click","[data-confirm]",function(n){n.preventDefault();var o=e(this),i=o.attr("href"),a=o.data("confirm");return!!i.length&&(a.length?s.ui.confirm(a,function(){t.location.href=i}):void(t.location.href=i))})})}(window.jQuery||window.Zepto,window,document);
